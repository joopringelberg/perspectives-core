// Generated by purs version 0.11.7
"use strict";
var Control_Alt = require("../Control.Alt");
var Control_Applicative = require("../Control.Applicative");
var Control_Apply = require("../Control.Apply");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_Either = require("../Data.Either");
var Data_Eq = require("../Data.Eq");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_Generic_Rep = require("../Data.Generic.Rep");
var Data_Generic_Rep_Show = require("../Data.Generic.Rep.Show");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra");
var Data_Identity = require("../Data.Identity");
var Data_Lens = require("../Data.Lens");
var Data_Lens_Internal_Wander = require("../Data.Lens.Internal.Wander");
var Data_Maybe = require("../Data.Maybe");
var Data_Ord = require("../Data.Ord");
var Data_Ordering = require("../Data.Ordering");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Show = require("../Data.Show");
var Data_Symbol = require("../Data.Symbol");
var Prelude = require("../Prelude");
var Text_Parsing_Parser = require("../Text.Parsing.Parser");
var URI_Authority = require("../URI.Authority");
var URI_Common = require("../URI.Common");
var URI_Path = require("../URI.Path");
var URI_Path_Absolute = require("../URI.Path.Absolute");
var URI_Path_NoScheme = require("../URI.Path.NoScheme");
var RelativePartAuth = (function () {
    function RelativePartAuth(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    RelativePartAuth.create = function (value0) {
        return function (value1) {
            return new RelativePartAuth(value0, value1);
        };
    };
    return RelativePartAuth;
})();
var RelativePartNoAuth = (function () {
    function RelativePartNoAuth(value0) {
        this.value0 = value0;
    };
    RelativePartNoAuth.create = function (value0) {
        return new RelativePartNoAuth(value0);
    };
    return RelativePartNoAuth;
})();
var print = function (opts) {
    return function (v) {
        if (v instanceof RelativePartAuth) {
            return URI_Authority.print(opts)(v.value0) + URI_Path.print(opts.printPath(v.value1));
        };
        if (v instanceof RelativePartNoAuth) {
            return Data_Maybe.maybe("")(function ($85) {
                return Data_Either.either(URI_Path_Absolute.print)(URI_Path_NoScheme.print)(opts.printRelPath($85));
            })(v.value0);
        };
        throw new Error("Failed pattern match at URI.RelativePart line 117, column 14 - line 121, column 79: " + [ v.constructor.name ]);
    };
};
var parser = function (opts) {
    var withAuth = Control_Apply.apply(Text_Parsing_Parser.applyParserT(Data_Identity.monadIdentity))(Data_Functor.map(Text_Parsing_Parser.functorParserT(Data_Identity.functorIdentity))(RelativePartAuth.create)(URI_Authority.parser(opts)))(URI_Common.wrapParser(Data_Identity.monadIdentity)(opts.parsePath)(URI_Path.parser));
    var noAuthPath = Control_Alt.alt(Text_Parsing_Parser.altParserT(Data_Identity.monadIdentity))(Control_Alt.alt(Text_Parsing_Parser.altParserT(Data_Identity.monadIdentity))(Data_Functor.map(Text_Parsing_Parser.functorParserT(Data_Identity.functorIdentity))(Data_Maybe.Just.create)(URI_Common.wrapParser(Data_Identity.monadIdentity)(function ($86) {
        return opts.parseRelPath(Data_Either.Left.create($86));
    })(URI_Path_Absolute.parse)))(Data_Functor.map(Text_Parsing_Parser.functorParserT(Data_Identity.functorIdentity))(Data_Maybe.Just.create)(URI_Common.wrapParser(Data_Identity.monadIdentity)(function ($87) {
        return opts.parseRelPath(Data_Either.Right.create($87));
    })(URI_Path_NoScheme.parse))))(Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Data_Identity.monadIdentity))(Data_Maybe.Nothing.value));
    var withoutAuth = Data_Functor.map(Text_Parsing_Parser.functorParserT(Data_Identity.functorIdentity))(RelativePartNoAuth.create)(noAuthPath);
    return Control_Alt.alt(Text_Parsing_Parser.altParserT(Data_Identity.monadIdentity))(withAuth)(withoutAuth);
};
var genericRelativePart = new Data_Generic_Rep.Generic(function (x) {
    if (x instanceof RelativePartAuth) {
        return new Data_Generic_Rep.Inl(new Data_Generic_Rep.Product(x.value0, x.value1));
    };
    if (x instanceof RelativePartNoAuth) {
        return new Data_Generic_Rep.Inr(x.value0);
    };
    throw new Error("Failed pattern match at URI.RelativePart line 50, column 8 - line 50, column 91: " + [ x.constructor.name ]);
}, function (x) {
    if (x instanceof Data_Generic_Rep.Inl) {
        return new RelativePartAuth(x.value0.value0, x.value0.value1);
    };
    if (x instanceof Data_Generic_Rep.Inr) {
        return new RelativePartNoAuth(x.value0);
    };
    throw new Error("Failed pattern match at URI.RelativePart line 50, column 8 - line 50, column 91: " + [ x.constructor.name ]);
});
var showRelativePart = function (dictShow) {
    return function (dictShow1) {
        return function (dictShow2) {
            return function (dictShow3) {
                return new Data_Show.Show(Data_Generic_Rep_Show.genericShow(genericRelativePart)(Data_Generic_Rep_Show.genericShowSum(Data_Generic_Rep_Show.genericShowConstructor(Data_Generic_Rep_Show.genericShowArgsProduct(Data_Generic_Rep_Show.genericShowArgsArgument(URI_Authority.showAuthority(dictShow)(dictShow1)))(Data_Generic_Rep_Show.genericShowArgsArgument(dictShow2)))(new Data_Symbol.IsSymbol(function () {
                    return "RelativePartAuth";
                })))(Data_Generic_Rep_Show.genericShowConstructor(Data_Generic_Rep_Show.genericShowArgsArgument(Data_Maybe.showMaybe(dictShow3)))(new Data_Symbol.IsSymbol(function () {
                    return "RelativePartNoAuth";
                })))));
            };
        };
    };
};
var eqRelativePart = function (dictEq) {
    return function (dictEq1) {
        return function (dictEq2) {
            return function (dictEq3) {
                return new Data_Eq.Eq(function (x) {
                    return function (y) {
                        if (x instanceof RelativePartAuth && y instanceof RelativePartAuth) {
                            return Data_Eq.eq(URI_Authority.eqAuthority(dictEq)(dictEq1))(x.value0)(y.value0) && Data_Eq.eq(dictEq2)(x.value1)(y.value1);
                        };
                        if (x instanceof RelativePartNoAuth && y instanceof RelativePartNoAuth) {
                            return Data_Eq.eq(Data_Maybe.eqMaybe(dictEq3))(x.value0)(y.value0);
                        };
                        return false;
                    };
                });
            };
        };
    };
};
var ordRelativePart = function (dictOrd) {
    return function (dictOrd1) {
        return function (dictOrd2) {
            return function (dictOrd3) {
                return new Data_Ord.Ord(function () {
                    return eqRelativePart(dictOrd.Eq0())(dictOrd1.Eq0())(dictOrd2.Eq0())(dictOrd3.Eq0());
                }, function (x) {
                    return function (y) {
                        if (x instanceof RelativePartAuth && y instanceof RelativePartAuth) {
                            var v = Data_Ord.compare(URI_Authority.ordAuthority(dictOrd)(dictOrd1))(x.value0)(y.value0);
                            if (v instanceof Data_Ordering.LT) {
                                return Data_Ordering.LT.value;
                            };
                            if (v instanceof Data_Ordering.GT) {
                                return Data_Ordering.GT.value;
                            };
                            return Data_Ord.compare(dictOrd2)(x.value1)(y.value1);
                        };
                        if (x instanceof RelativePartAuth) {
                            return Data_Ordering.LT.value;
                        };
                        if (y instanceof RelativePartAuth) {
                            return Data_Ordering.GT.value;
                        };
                        if (x instanceof RelativePartNoAuth && y instanceof RelativePartNoAuth) {
                            return Data_Ord.compare(Data_Maybe.ordMaybe(dictOrd3))(x.value0)(y.value0);
                        };
                        throw new Error("Failed pattern match at URI.RelativePart line 49, column 8 - line 49, column 132: " + [ x.constructor.name, y.constructor.name ]);
                    };
                });
            };
        };
    };
};
var _relPath = function (dictWander) {
    return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
        return function (f) {
            return function (a) {
                if (a instanceof RelativePartNoAuth) {
                    return Data_Functor.map((dictApplicative.Apply0()).Functor0())(RelativePartNoAuth.create)(f(a.value0));
                };
                return Control_Applicative.pure(dictApplicative)(a);
            };
        };
    });
};
var _path = function (dictWander) {
    return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
        return function (f) {
            return function (v) {
                if (v instanceof RelativePartAuth) {
                    return Data_Functor.map((dictApplicative.Apply0()).Functor0())(RelativePartAuth.create(v.value0))(f(v.value1));
                };
                return Control_Applicative.pure(dictApplicative)(v);
            };
        };
    });
};
var _authority = function (dictWander) {
    return Data_Lens_Internal_Wander.wander(dictWander)(function (dictApplicative) {
        return function (f) {
            return function (v) {
                if (v instanceof RelativePartAuth) {
                    return Data_Functor.map((dictApplicative.Apply0()).Functor0())(Data_Function.flip(RelativePartAuth.create)(v.value1))(f(v.value0));
                };
                return Control_Applicative.pure(dictApplicative)(v);
            };
        };
    });
};
module.exports = {
    RelativePartAuth: RelativePartAuth,
    RelativePartNoAuth: RelativePartNoAuth,
    parser: parser,
    print: print,
    _authority: _authority,
    _path: _path,
    _relPath: _relPath,
    eqRelativePart: eqRelativePart,
    ordRelativePart: ordRelativePart,
    genericRelativePart: genericRelativePart,
    showRelativePart: showRelativePart
};
