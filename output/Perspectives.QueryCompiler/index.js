// Generated by purs version 0.11.7
"use strict";
var Control_Applicative = require("../Control.Applicative");
var Control_Apply = require("../Control.Apply");
var Control_Bind = require("../Control.Bind");
var Control_Category = require("../Control.Category");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad_Eff_Exception = require("../Control.Monad.Eff.Exception");
var Control_Monad_Error_Class = require("../Control.Monad.Error.Class");
var Control_Monad_Reader_Trans = require("../Control.Monad.Reader.Trans");
var Control_Monad_State_Trans = require("../Control.Monad.State.Trans");
var Control_Monad_Trans_Class = require("../Control.Monad.Trans.Class");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_Array = require("../Data.Array");
var Data_Foldable = require("../Data.Foldable");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Traversable = require("../Data.Traversable");
var Perspectives_ComputedTripleGetters = require("../Perspectives.ComputedTripleGetters");
var Perspectives_CoreTypes = require("../Perspectives.CoreTypes");
var Perspectives_DataTypeObjectGetters = require("../Perspectives.DataTypeObjectGetters");
var Perspectives_DataTypeTripleGetters = require("../Perspectives.DataTypeTripleGetters");
var Perspectives_Effects = require("../Perspectives.Effects");
var Perspectives_EntiteitAndRDFAliases = require("../Perspectives.EntiteitAndRDFAliases");
var Perspectives_ObjectGetterConstructors = require("../Perspectives.ObjectGetterConstructors");
var Perspectives_ObjectsGetterComposition = require("../Perspectives.ObjectsGetterComposition");
var Perspectives_QueryCache = require("../Perspectives.QueryCache");
var Perspectives_QueryCombinators = require("../Perspectives.QueryCombinators");
var Perspectives_RunMonadPerspectivesQuery = require("../Perspectives.RunMonadPerspectivesQuery");
var Perspectives_TripleGetterComposition = require("../Perspectives.TripleGetterComposition");
var Perspectives_TripleGetterConstructors = require("../Perspectives.TripleGetterConstructors");
var Perspectives_Utilities = require("../Perspectives.Utilities");
var Prelude = require("../Prelude");
var rolQuery = function (rn) {
    return Perspectives_Utilities.ifNothing(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_QueryCache.queryCacheLookup(rn))(Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_CoreTypes.applyObjectsGetterToObject(rn)(Perspectives_DataTypeObjectGetters.contextType))(function (v) {
        return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(constructQueryFunction(v))(function (v1) {
            return Perspectives_QueryCache.queryCacheInsert(v1.value0)(new Perspectives_CoreTypes.TypedTripleGetter(v1.value0, function ($51) {
                return Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetter(v1)($51));
            }));
        });
    }))(function ($52) {
        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Control_Category.id(Control_Category.categoryFn)($52));
    });
};
var propertyQuery = function (rn) {
    return rolQuery(rn);
};
var constructQueryFunction = function (typeDescriptionID) {
    var getBindingOfRol = function (rolName) {
        return Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_ObjectGetterConstructors.getRol(rolName))(Perspectives_DataTypeObjectGetters.rolBindingDef);
    };
    var errorMessage = function (s) {
        return function (t) {
            return Control_Monad_Eff_Exception.error("constructQueryFunction: " + (s + (" for: " + (t + (" " + typeDescriptionID)))));
        };
    };
    var applyUnaryCombinator = function (c) {
        return function (queryStepType) {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no query provided")(queryStepType))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(getBindingOfRol("model:QueryAst$UnaryCombinator$query"))))(function (v) {
                return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(constructQueryFunction(v))(function ($53) {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(c($53));
                });
            });
        };
    };
    var applyBinaryCombinator = function (c) {
        return function (queryStepType) {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_ObjectGetterConstructors.getRol("model:QueryAST$nAryCombinator$operand"))(Perspectives_DataTypeObjectGetters.rolBindingDef)(typeDescriptionID))(function (v) {
                return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(constructQueryFunction)(v))(function (v1) {
                    return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities["onNothing'"](Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("too few operands")(queryStepType))(Data_Array.unsnoc(v1)))(function (v2) {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Data_Foldable.foldl(Data_Foldable.foldableArray)(c)(v2.last)(v2.init));
                    });
                });
            });
        };
    };
    return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no type found")(""))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_DataTypeObjectGetters.contextType)))(function (v) {
        if (v === "model:QueryAst$DataTypeGetter") {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no function name provided")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectGetterConstructors.getExternalProperty("model:QueryAst$DataTypeGetter$buitenRolBeschrijving$functionName"))))(function (v1) {
                if (v1 === "binding") {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_DataTypeTripleGetters.bindingM);
                };
                if (v1 === "context") {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_DataTypeTripleGetters.contextM);
                };
                if (v1 === "identity") {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_DataTypeTripleGetters.identityM);
                };
                if (v1 === "contextType") {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_DataTypeTripleGetters.contextTypeM);
                };
                if (v1 === "rolType") {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_DataTypeTripleGetters.rolTypeM);
                };
                if (v1 === "buitenRol") {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_DataTypeTripleGetters.buitenRolM);
                };
                if (v1 === "iedereRolInContext") {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_DataTypeTripleGetters.iedereRolInContextM);
                };
                if (v1 === "label") {
                    return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_DataTypeTripleGetters.labelM);
                };
                return Control_Monad_Error_Class.throwError(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(Control_Monad_Eff_Exception.error("constructQueryFunction: unknown function for DataTypeGetter: '" + (v1 + "'")));
            });
        };
        if (v === "model:QueryAst$PropertyGetter") {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no function name provided")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectGetterConstructors.getExternalProperty("model:QueryAst$PropertyGetter$buitenRolBeschrijving$functionName"))))(function (v1) {
                return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no property provided")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(getBindingOfRol("model:QueryAst$PropertyGetter$property"))))(function (v2) {
                    if (v1 === "constructExternalPropertyGetter") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructExternalPropertyGetter(v2));
                    };
                    if (v1 === "constructExternalPropertyLookup") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructExternalPropertyLookup(v2));
                    };
                    if (v1 === "constructRolPropertyLookup") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructRolPropertyLookup(v2));
                    };
                    if (v1 === "constructRolPropertyGetter") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructRolPropertyGetter(v2));
                    };
                    if (v1 === "propertyQuery") {
                        return propertyQuery(v2);
                    };
                    if (v1 === "constructInternalPropertyLookup") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructInternalPropertyLookup(v2));
                    };
                    if (v1 === "constructInternalPropertyGetter") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructInternalPropertyGetter(v2));
                    };
                    return Control_Monad_Error_Class.throwError(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(Control_Monad_Eff_Exception.error("constructQueryFunction: unknown function for PropertyGetter: '" + (v1 + "'")));
                });
            });
        };
        if (v === "model:QueryAst$RolGetter") {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no function name provided")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectGetterConstructors.getExternalProperty("model:QueryAst$RolGetter$buitenRolBeschrijving$functionName"))))(function (v1) {
                return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no rol provided")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(getBindingOfRol("model:QueryAst$RolGetter$rol"))))(function (v2) {
                    if (v1 === "constructRolGetter") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructRolGetter(v2));
                    };
                    if (v1 === "rolQuery") {
                        return rolQuery(v2);
                    };
                    if (v1 === "constructRolLookup") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructRolLookup(v2));
                    };
                    if (v1 === "constructInverseRolGetter") {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_TripleGetterConstructors.constructInverseRolGetter(v2));
                    };
                    if (v1 === "computedRolGetter") {
                        if (v2 === "model:Systeem$Systeem$modellen") {
                            return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_ComputedTripleGetters.modellenM);
                        };
                        return Control_Monad_Error_Class.throwError(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(Control_Monad_Eff_Exception.error("constructQueryFunction: unknown function for computedRolGetter: '" + (v1 + "'")));
                    };
                    return Control_Monad_Error_Class.throwError(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(Control_Monad_Eff_Exception.error("constructQueryFunction: unknown function for RolGetter: '" + (v1 + "'")));
                });
            });
        };
        if (v === "model:QueryAst$rolesOf") {
            return Data_Functor.map(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff))(Perspectives_QueryCombinators.rolesOf)(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no context")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(v)(getBindingOfRol("model:QueryAst$rolesOf$context"))));
        };
        if (v === "model:QueryAst$UnaryCombinator") {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no function name provided")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectGetterConstructors.getExternalProperty("model:QueryAst$UnaryCombinator$buitenRolBeschrijving$functionName"))))(function (v1) {
                if (v1 === "laatste") {
                    return applyUnaryCombinator(Perspectives_QueryCombinators.lastElement)(v);
                };
                if (v1 === "notEmpty") {
                    return applyUnaryCombinator(Perspectives_QueryCombinators.notEmpty)(v);
                };
                if (v1 === "closure") {
                    return applyUnaryCombinator(Perspectives_QueryCombinators.closure)(v);
                };
                if (v1 === "closure'") {
                    return applyUnaryCombinator(Perspectives_QueryCombinators["closure'"])(v);
                };
                if (v1 === "useCache") {
                    return applyUnaryCombinator(Perspectives_QueryCombinators.useCache)(v);
                };
                if (v1 === "ignoreCache") {
                    return applyUnaryCombinator(Perspectives_QueryCombinators.ignoreCache)(v);
                };
                return Control_Monad_Error_Class.throwError(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(Control_Monad_Eff_Exception.error("constructQueryFunction: unknown function for UnaryCombinator: '" + (v1 + "'")));
            });
        };
        if (v === "model:QueryAst$nAryCombinator") {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no function name provided")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectGetterConstructors.getExternalProperty("model:QueryAst$UnaryCombinator$buitenRolBeschrijving$functionName"))))(function (v1) {
                if (v1 === "compose") {
                    return applyBinaryCombinator(Perspectives_TripleGetterComposition.composeTripleGetters)(v);
                };
                if (v1 === "concat") {
                    return applyBinaryCombinator(Perspectives_QueryCombinators.concat)(v);
                };
                return Control_Monad_Error_Class.throwError(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(Control_Monad_Eff_Exception.error("constructQueryFunction: unknown function for nAryCombinator: '" + (v1 + "'")));
            });
        };
        if (v === "model:QueryAst$filter") {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no criterium")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(getBindingOfRol("model:QueryAST$filter$criterium"))))(function (v1) {
                return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no candidates")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(getBindingOfRol("model:QueryAST$filter$candidates"))))(function (v2) {
                    return Control_Apply.apply(Control_Monad_Reader_Trans.applyReaderT(Control_Monad_Aff.applyAff))(Data_Functor.map(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff))(Perspectives_QueryCombinators.filter)(constructQueryFunction(v1)))(constructQueryFunction(v2));
                });
            });
        };
        if (v === "model:QueryAst$Constant") {
            return Data_Functor.map(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff))(Perspectives_QueryCombinators.constant)(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no constant value provided")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectGetterConstructors.getExternalProperty("model:QueryAst$Constant$value"))));
        };
        if (v === "model:QueryAst$Variable") {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no variable name found")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectGetterConstructors.getInternalProperty("model:QueryAst$Variable$name"))))(function (v1) {
                return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_QueryCombinators.ref(v1));
            });
        };
        if (v === "model:QueryAst$setVariable") {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no variable name found")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectGetterConstructors.getInternalProperty("model:QueryAst$Variable$name"))))(function (v1) {
                return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_Utilities.onNothing(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(errorMessage("no value found")(v))(Perspectives_CoreTypes.applyObjectsGetterToMaybeObject(typeDescriptionID)(Perspectives_ObjectsGetterComposition.unionOfObjects(getBindingOfRol("model:QueryAST$setVariable$value"))(Perspectives_DataTypeObjectGetters.rolBindingDef))))(function (v2) {
                    return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(constructQueryFunction(v2))(function (v3) {
                        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Perspectives_QueryCombinators["var"](v1)(v3));
                    });
                });
            });
        };
        return Control_Monad_Error_Class.throwError(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(Control_Monad_Eff_Exception.error("constructQueryFunction: unknown type description: '" + (typeDescriptionID + "'")));
    });
};
module.exports = {
    rolQuery: rolQuery,
    propertyQuery: propertyQuery,
    constructQueryFunction: constructQueryFunction
};
