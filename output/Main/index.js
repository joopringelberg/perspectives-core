// Generated by purs version 0.11.7
"use strict";
var Control_Aff_Sockets = require("../Control.Aff.Sockets");
var Control_Applicative = require("../Control.Applicative");
var Control_Bind = require("../Control.Bind");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad_Aff_AVar = require("../Control.Monad.Aff.AVar");
var Control_Monad_Eff = require("../Control.Monad.Eff");
var Control_Monad_Eff_Console = require("../Control.Monad.Eff.Console");
var Control_Monad_Eff_Exception = require("../Control.Monad.Eff.Exception");
var DOM = require("../DOM");
var Data_Either = require("../Data.Either");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Show = require("../Data.Show");
var Perspectives_Api = require("../Perspectives.Api");
var Perspectives_Effects = require("../Perspectives.Effects");
var Perspectives_PerspectivesState = require("../Perspectives.PerspectivesState");
var Prelude = require("../Prelude");
var handleError = function (v) {
    if (v instanceof Data_Either.Left) {
        return Control_Monad_Eff_Console.log("An error condition: " + Data_Show.show(Control_Monad_Eff_Exception.showError)(v.value0));
    };
    if (v instanceof Data_Either.Right) {
        return Control_Monad_Eff_Console.log("Success!");
    };
    throw new Error("Failed pattern match at Main line 46, column 1 - line 46, column 81: " + [ v.constructor.name ]);
};
var main = Data_Functor["void"](Control_Monad_Eff.functorEff)(Control_Monad_Aff.runAff(handleError)(Control_Bind.bind(Control_Monad_Aff.bindAff)(Control_Applicative.pure(Control_Monad_Aff.applicativeAff)("cor"))(function (v) {
    return Control_Bind.bind(Control_Monad_Aff.bindAff)(Control_Applicative.pure(Control_Monad_Aff.applicativeAff)("geheim"))(function (v1) {
        return Control_Bind.bind(Control_Monad_Aff.bindAff)(Control_Applicative.pure(Control_Monad_Aff.applicativeAff)("http://127.0.0.1:5984/"))(function (v2) {
            return Control_Bind.bind(Control_Monad_Aff.bindAff)(Control_Monad_Aff_AVar.makeVar("This value will be removed on first authentication!"))(function (v3) {
                return Control_Bind.bind(Control_Monad_Aff.bindAff)(Control_Monad_Aff_AVar.makeVar(Perspectives_PerspectivesState.newPerspectivesState({
                    userName: v,
                    couchdbPassword: v1,
                    couchdbBaseURL: v2
                })(v3)))(function (v4) {
                    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Aff.bindAff)(Data_Functor["void"](Control_Monad_Aff.functorAff)(Control_Monad_Aff.forkAff(Perspectives_PerspectivesState.runPerspectivesWithState(Perspectives_Api.setupApi)(v4))))(function () {
                        return Data_Functor["void"](Control_Monad_Aff.functorAff)(Control_Monad_Aff.forkAff(Perspectives_PerspectivesState.runPerspectivesWithState(Perspectives_Api.setupTcpApi)(v4)));
                    });
                });
            });
        });
    });
})));
module.exports = {
    main: main,
    handleError: handleError
};
