// Generated by purs version 0.11.7
"use strict";
var Control_Alt = require("../Control.Alt");
var Control_Applicative = require("../Control.Applicative");
var Control_Apply = require("../Control.Apply");
var Control_Bind = require("../Control.Bind");
var Control_Category = require("../Control.Category");
var Control_Monad = require("../Control.Monad");
var Control_Monad_State = require("../Control.Monad.State");
var Control_Monad_State_Class = require("../Control.Monad.State.Class");
var Control_Monad_State_Trans = require("../Control.Monad.State.Trans");
var Control_Monad_Trans_Class = require("../Control.Monad.Trans.Class");
var Data_Eq = require("../Data.Eq");
var Data_Function = require("../Data.Function");
var Data_List = require("../Data.List");
var Data_List_Types = require("../Data.List.Types");
var Data_Maybe = require("../Data.Maybe");
var Data_Ord = require("../Data.Ord");
var Data_Unit = require("../Data.Unit");
var Prelude = require("../Prelude");
var Text_Parsing_Parser = require("../Text.Parsing.Parser");
var Text_Parsing_Parser_Combinators = require("../Text.Parsing.Parser.Combinators");
var Text_Parsing_Parser_Pos = require("../Text.Parsing.Parser.Pos");
var Text_Parsing_Parser_String = require("../Text.Parsing.Parser.String");
var Opt = (function () {
    function Opt(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Opt.create = function (value0) {
        return function (value1) {
            return new Opt(value0, value1);
        };
    };
    return Opt;
})();
var symbol = function (dictMonad) {
    return function (name) {
        return Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(dictMonad))(Data_List.many(Text_Parsing_Parser.alternativeParserT(dictMonad))(Text_Parsing_Parser.lazyParserT)(Text_Parsing_Parser_String.oneOf(Text_Parsing_Parser_String.stringLikeString)(dictMonad)([ " ", "\x09" ])))(Text_Parsing_Parser_String.string(Text_Parsing_Parser_String.stringLikeString)(dictMonad)(name));
    };
};
var sourceLine = function (v) {
    return v.line;
};
var sourceColumn = function (v) {
    return v.column;
};
var setSourceLine = function (v) {
    return function (l) {
        return {
            line: l,
            column: v.column
        };
    };
};
var runIndent = function (dictMonad) {
    return Data_Function.flip(Control_Monad_State_Trans.evalStateT(((dictMonad.Bind1()).Apply0()).Functor0()))(Text_Parsing_Parser_Pos.initialPos);
};
var put$prime = function (dictMonad) {
    return function (p) {
        return Control_Monad_Trans_Class.lift(Text_Parsing_Parser.monadTransParserT)(Control_Monad_State_Trans.monadStateT(dictMonad))(Control_Monad_State_Class.put(Control_Monad_State_Trans.monadStateStateT(dictMonad))(p));
    };
};
var many1 = function (dictMonad) {
    return function (p) {
        return Control_Apply.lift2(Text_Parsing_Parser.applyParserT(dictMonad))(Data_List_Types.Cons.create)(p)(Data_List.many(Text_Parsing_Parser.alternativeParserT(dictMonad))(Text_Parsing_Parser.lazyParserT)(p));
    };
};
var getPosition = function (dictMonad) {
    return Control_Monad_State_Class.gets(Text_Parsing_Parser.monadStateParserT(dictMonad))(function (v) {
        return v.value1;
    });
};
var get$prime = function (dictMonad) {
    return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Control_Monad_Trans_Class.lift(Text_Parsing_Parser.monadTransParserT)(Control_Monad_State_Trans.monadStateT(dictMonad))(Control_Monad_State_Class.get(Control_Monad_State_Trans.monadStateStateT(dictMonad))))(function (v) {
        return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(v);
    });
};
var withPos = function (dictMonad) {
    return function (x) {
        return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(get$prime(dictMonad))(function (v) {
            return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(getPosition(Control_Monad_State_Trans.monadStateT(dictMonad)))(function (v1) {
                return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(put$prime(dictMonad)(v1))(x))(function (v2) {
                    return Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(put$prime(dictMonad)(v))(Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(v2));
                });
            });
        });
    };
};
var biAp = function (f) {
    return function (c) {
        return function (v1) {
            return function (v2) {
                return c(f(v1))(f(v2));
            };
        };
    };
};
var checkIndent = function (dictMonad) {
    return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(get$prime(dictMonad))(function (v) {
        return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(getPosition(Control_Monad_State_Trans.monadStateT(dictMonad)))(function (v1) {
            var $65 = biAp(sourceColumn)(Data_Eq.eq(Data_Eq.eqInt))(v1)(v);
            if ($65) {
                return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Data_Unit.unit);
            };
            return Text_Parsing_Parser.fail(Control_Monad_State_Trans.monadStateT(dictMonad))("indentation doesn't match");
        });
    });
};
var block = function (dictMonad) {
    return function (p) {
        return withPos(dictMonad)(Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Data_List.many(Text_Parsing_Parser.alternativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Text_Parsing_Parser.lazyParserT)(Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(checkIndent(dictMonad))(p)))(function (v) {
            return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(v);
        }));
    };
};
var block1 = function (dictMonad) {
    return function (p) {
        return withPos(dictMonad)(Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(many1(Control_Monad_State_Trans.monadStateT(dictMonad))(Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(checkIndent(dictMonad))(p)))(function (v) {
            return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(v);
        }));
    };
};
var indented = function (dictMonad) {
    return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(getPosition(Control_Monad_State_Trans.monadStateT(dictMonad)))(function (v) {
        return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(get$prime(dictMonad))(function (v1) {
            var $70 = biAp(sourceColumn)(Data_Ord.lessThanOrEq(Data_Ord.ordInt))(v)(v1);
            if ($70) {
                return Text_Parsing_Parser.fail(Control_Monad_State_Trans.monadStateT(dictMonad))("not indented");
            };
            return Control_Bind.discard(Control_Bind.discardUnit)(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(put$prime(dictMonad)(setSourceLine(v1)(sourceLine(v))))(function () {
                return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Data_Unit.unit);
            });
        });
    });
};
var withBlock = function (dictMonad) {
    return function (f) {
        return function (a) {
            return function (p) {
                return withPos(dictMonad)(Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(a)(function (v) {
                    return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Text_Parsing_Parser_Combinators.optionMaybe(Control_Monad_State_Trans.monadStateT(dictMonad))(Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(indented(dictMonad))(block(dictMonad)(p))))(function (v1) {
                        if (v1 instanceof Data_Maybe.Nothing) {
                            return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(f(v)(Data_List_Types.Nil.value));
                        };
                        if (v1 instanceof Data_Maybe.Just) {
                            return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(f(v)(v1.value0));
                        };
                        throw new Error("Failed pattern match at Text.Parsing.Indent line 112, column 5 - line 114, column 32: " + [ v1.constructor.name ]);
                    });
                }));
            };
        };
    };
};
var withBlock$prime = function (dictMonad) {
    return withBlock(dictMonad)(Data_Function.flip(Data_Function["const"]));
};
var indented$prime = function (dictMonad) {
    return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(getPosition(Control_Monad_State_Trans.monadStateT(dictMonad)))(function (v) {
        return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(get$prime(dictMonad))(function (v1) {
            var $77 = biAp(sourceColumn)(Data_Ord.lessThanOrEq(Data_Ord.ordInt))(v)(v1);
            if ($77) {
                return Text_Parsing_Parser.fail(Control_Monad_State_Trans.monadStateT(dictMonad))("not indented");
            };
            return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Data_Unit.unit);
        });
    });
};
var sameLine = function (dictMonad) {
    return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(getPosition(Control_Monad_State_Trans.monadStateT(dictMonad)))(function (v) {
        return Control_Bind.bind(Text_Parsing_Parser.bindParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(get$prime(dictMonad))(function (v1) {
            var $80 = biAp(sourceLine)(Data_Eq.eq(Data_Eq.eqInt))(v)(v1);
            if ($80) {
                return Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Data_Unit.unit);
            };
            return Text_Parsing_Parser.fail(Control_Monad_State_Trans.monadStateT(dictMonad))("over one line");
        });
    });
};
var sameOrIndented = function (dictMonad) {
    return Control_Alt.alt(Text_Parsing_Parser.altParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(sameLine(dictMonad))(indented(dictMonad));
};
var indentAp = function (dictMonad) {
    return function (a) {
        return function (b) {
            return Control_Monad.ap(Text_Parsing_Parser.monadParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(a)(Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(sameOrIndented(dictMonad))(b));
        };
    };
};
var indentMany = function (dictMonad) {
    return function (a) {
        return function (b) {
            return Control_Monad.ap(Text_Parsing_Parser.monadParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(a)(Data_List.many(Text_Parsing_Parser.alternativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Text_Parsing_Parser.lazyParserT)(Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(sameOrIndented(dictMonad))(b)));
        };
    };
};
var indentNoAp = function (dictMonad) {
    return function (a) {
        return function (b) {
            return Control_Apply.lift2(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Data_Function["const"])(a)(Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(sameOrIndented(dictMonad))(b));
        };
    };
};
var indentAngles = function (dictMonad) {
    return function (p) {
        return withPos(dictMonad)(indentAp(dictMonad)(indentNoAp(dictMonad)(Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Control_Category.id(Control_Category.categoryFn)))(symbol(Control_Monad_State_Trans.monadStateT(dictMonad))("<")))(indentNoAp(dictMonad)(p)(symbol(Control_Monad_State_Trans.monadStateT(dictMonad))(">"))));
    };
};
var indentBraces = function (dictMonad) {
    return function (p) {
        return withPos(dictMonad)(indentAp(dictMonad)(indentNoAp(dictMonad)(Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Control_Category.id(Control_Category.categoryFn)))(symbol(Control_Monad_State_Trans.monadStateT(dictMonad))("{")))(indentNoAp(dictMonad)(p)(symbol(Control_Monad_State_Trans.monadStateT(dictMonad))("}"))));
    };
};
var indentBrackets = function (dictMonad) {
    return function (p) {
        return withPos(dictMonad)(indentAp(dictMonad)(indentNoAp(dictMonad)(Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Control_Category.id(Control_Category.categoryFn)))(symbol(Control_Monad_State_Trans.monadStateT(dictMonad))("[")))(indentNoAp(dictMonad)(p)(symbol(Control_Monad_State_Trans.monadStateT(dictMonad))("]"))));
    };
};
var indentParens = function (dictMonad) {
    return function (p) {
        return withPos(dictMonad)(indentAp(dictMonad)(indentNoAp(dictMonad)(Control_Applicative.pure(Text_Parsing_Parser.applicativeParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(Control_Category.id(Control_Category.categoryFn)))(symbol(Control_Monad_State_Trans.monadStateT(dictMonad))("(")))(indentNoAp(dictMonad)(p)(symbol(Control_Monad_State_Trans.monadStateT(dictMonad))(")"))));
    };
};
var indentOp = function (dictMonad) {
    return function (a) {
        return function (v) {
            return Control_Monad.ap(Text_Parsing_Parser.monadParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(a)(Text_Parsing_Parser_Combinators.option(Control_Monad_State_Trans.monadStateT(dictMonad))(v.value0)(Control_Apply.applySecond(Text_Parsing_Parser.applyParserT(Control_Monad_State_Trans.monadStateT(dictMonad)))(sameOrIndented(dictMonad))(v.value1)));
        };
    };
};
module.exports = {
    runIndent: runIndent,
    withBlock: withBlock,
    "withBlock'": withBlock$prime,
    block: block,
    block1: block1,
    indented: indented,
    "indented'": indented$prime,
    sameLine: sameLine,
    sameOrIndented: sameOrIndented,
    checkIndent: checkIndent,
    withPos: withPos,
    indentAp: indentAp,
    indentNoAp: indentNoAp,
    indentMany: indentMany,
    indentOp: indentOp,
    Opt: Opt
};
