// Generated by purs version 0.11.7
"use strict";
var Control_Applicative = require("../Control.Applicative");
var Control_Bind = require("../Control.Bind");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad_Eff_Exception = require("../Control.Monad.Eff.Exception");
var Control_Monad_Error_Class = require("../Control.Monad.Error.Class");
var Control_Monad_Reader_Trans = require("../Control.Monad.Reader.Trans");
var Control_Monad_State_Trans = require("../Control.Monad.State.Trans");
var Control_Monad_Trans_Class = require("../Control.Monad.Trans.Class");
var Control_Monad_Writer = require("../Control.Monad.Writer");
var Control_Monad_Writer_Class = require("../Control.Monad.Writer.Class");
var Control_Monad_Writer_Trans = require("../Control.Monad.Writer.Trans");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_Argonaut_Core = require("../Data.Argonaut.Core");
var Data_Argonaut_Decode = require("../Data.Argonaut.Decode");
var Data_Argonaut_Decode_Class = require("../Data.Argonaut.Decode.Class");
var Data_Array = require("../Data.Array");
var Data_DateTime_ISO = require("../Data.DateTime.ISO");
var Data_Either = require("../Data.Either");
var Data_Eq = require("../Data.Eq");
var Data_Foldable = require("../Data.Foldable");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_Maybe = require("../Data.Maybe");
var Data_Monoid = require("../Data.Monoid");
var Data_Number = require("../Data.Number");
var Data_Ord = require("../Data.Ord");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Show = require("../Data.Show");
var Data_StrMap = require("../Data.StrMap");
var Data_Traversable = require("../Data.Traversable");
var Data_Unit = require("../Data.Unit");
var Perpectives_TypeChecker = require("../Perpectives.TypeChecker");
var Perspectives_CoreTypes = require("../Perspectives.CoreTypes");
var Perspectives_DataTypeObjectGetters = require("../Perspectives.DataTypeObjectGetters");
var Perspectives_DataTypeTripleGetters = require("../Perspectives.DataTypeTripleGetters");
var Perspectives_DomeinCache = require("../Perspectives.DomeinCache");
var Perspectives_DomeinFile = require("../Perspectives.DomeinFile");
var Perspectives_Effects = require("../Perspectives.Effects");
var Perspectives_EntiteitAndRDFAliases = require("../Perspectives.EntiteitAndRDFAliases");
var Perspectives_Identifiers = require("../Perspectives.Identifiers");
var Perspectives_ModelBasedTripleGetters = require("../Perspectives.ModelBasedTripleGetters");
var Perspectives_ObjectGetterConstructors = require("../Perspectives.ObjectGetterConstructors");
var Perspectives_QueryAST = require("../Perspectives.QueryAST");
var Perspectives_QueryCombinators = require("../Perspectives.QueryCombinators");
var Perspectives_QueryCompiler = require("../Perspectives.QueryCompiler");
var Perspectives_QueryFunctionDescriptionCompiler = require("../Perspectives.QueryFunctionDescriptionCompiler");
var Perspectives_RunMonadPerspectivesQuery = require("../Perspectives.RunMonadPerspectivesQuery");
var Perspectives_TripleGetterComposition = require("../Perspectives.TripleGetterComposition");
var Perspectives_Utilities = require("../Perspectives.Utilities");
var Prelude = require("../Prelude");
var rolIsMandatory = Perspectives_QueryCombinators.toBoolean(Perspectives_ModelBasedTripleGetters.rolIsVerplichtM);
var propertyIsMandatory = Perspectives_QueryCombinators.toBoolean(Perspectives_ModelBasedTripleGetters.propertyIsVerplichtM);
var propertyIsFunctional = Perspectives_QueryCombinators.toBoolean(Perspectives_ModelBasedTripleGetters.propertyIsFunctioneelM);
var getPropertyFunction = function (pn) {
    return function (rn) {
        return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_CoreTypes.runMonadPerspectivesQueryCompiler(rn)(Perspectives_QueryFunctionDescriptionCompiler.compileElementaryQueryStep(new Perspectives_QueryAST.QualifiedProperty(pn))(pn + "_getter")))(function (v) {
            if (v instanceof Data_Either.Left) {
                return Control_Monad_Error_Class.throwError(Control_Monad_Reader_Trans.monadThrowReaderT(Control_Monad_Aff.monadThrowAff))(Control_Monad_Eff_Exception.error(Data_Show.show(Perspectives_CoreTypes.showUserMessage)(v.value0)));
            };
            if (v instanceof Data_Either.Right) {
                return Perspectives_QueryCompiler.constructQueryFunction(v.value0);
            };
            throw new Error("Failed pattern match at Perspectives.TypeDefChecker line 182, column 3 - line 184, column 66: " + [ v.constructor.name ]);
        });
    };
};
var get = function (typeId) {
    return function (tg) {
        return Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetter(typeId)(tg))(function ($84) {
            return Control_Applicative.pure(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.tripleObjects($84));
        }));
    };
};
var comparePropertyInstanceToDefinition = function (cid) {
    return function (rid) {
        return function (propertyType) {
            var tryParseSimpleValue = function (sv) {
                return function (propertyValue) {
                    if (sv === "model:Perspectives$Number") {
                        return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Maybe.maybe(false)(Data_Function["const"](true))(Data_Number.fromString(propertyValue)));
                    };
                    if (sv === "model:Perspectives$Boolean") {
                        if (propertyValue === "true") {
                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(true);
                        };
                        if (propertyValue === "false") {
                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(true);
                        };
                        return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(false);
                    };
                    if (sv === "model:Perspectives$Date") {
                        var v = Data_Argonaut_Decode_Class.decodeJson(Data_DateTime_ISO.decodeJsonISO)(Data_Argonaut_Core.fromString(propertyValue));
                        if (v instanceof Data_Either.Left) {
                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(false);
                        };
                        if (v instanceof Data_Either.Right) {
                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(true);
                        };
                        throw new Error("Failed pattern match at Perspectives.TypeDefChecker line 172, column 9 - line 174, column 56: " + [ v.constructor.name ]);
                    };
                    return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(true);
                };
            };
            return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_CoreTypes.applyObjectsGetterToObject(rid)(Perspectives_DataTypeObjectGetters.rolType))))(function (v) {
                return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(getPropertyFunction(propertyType)(v))))(function (v1) {
                    return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetter(rid)(v1)))(function (v2) {
                        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit))(function () {
                            var v3 = Data_Array.head(v2.object);
                            if (v3 instanceof Data_Maybe.Nothing) {
                                return Control_Bind.ifM(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(propertyIsMandatory(propertyType)))(Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.MissingPropertyValue(cid, propertyType, rid) ]))(Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit));
                            };
                            if (v3 instanceof Data_Maybe.Just) {
                                return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetterToMaybeObject(propertyType)(Perspectives_ModelBasedTripleGetters.rangeDefM)))(function (v4) {
                                    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))((function () {
                                        if (v4 instanceof Data_Maybe.Nothing) {
                                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
                                        };
                                        if (v4 instanceof Data_Maybe.Just) {
                                            return Control_Bind.ifM(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(tryParseSimpleValue(v4.value0)(v3.value0))(Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit))(Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.IncorrectPropertyValue(cid, propertyType, v4.value0, v3.value0) ]));
                                        };
                                        throw new Error("Failed pattern match at Perspectives.TypeDefChecker line 151, column 7 - line 155, column 76: " + [ v4.constructor.name ]);
                                    })())(function () {
                                        var $48 = Data_Array.length(v2.object) < 2;
                                        if ($48) {
                                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
                                        };
                                        return Control_Bind.ifM(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(propertyIsFunctional(propertyType)))(Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.TooManyPropertyValues(cid, propertyType) ]))(Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit));
                                    });
                                });
                            };
                            throw new Error("Failed pattern match at Perspectives.TypeDefChecker line 145, column 3 - line 160, column 22: " + [ v3.constructor.name ]);
                        });
                    });
                });
            });
        };
    };
};
var checkInternalProperty = function (cid) {
    return function (propertyType) {
        return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
    };
};
var checkCyclicAspects = function (cid) {
    return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(cid)(Perspectives_ModelBasedTripleGetters.aspectenDefMClosure))))(function (v) {
        var v1 = Data_Array.elemIndex(Data_Eq.eqString)(cid)(v);
        if (v1 instanceof Data_Maybe.Nothing) {
            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
        };
        return Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.CycleInAspects(cid, v) ]);
    });
};
var checkAvailableRoles = function (typeId) {
    return function (cid) {
        var isDefined = function (rolType) {
            return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(typeId)(Perspectives_ModelBasedTripleGetters.rollenDefM))))(function (v) {
                var v1 = Data_Array.elemIndex(Data_Eq.eqString)(rolType)(v);
                if (v1 instanceof Data_Maybe.Nothing) {
                    return Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.RolNotDefined(rolType, cid, typeId) ]);
                };
                return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
            });
        };
        return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetterToObjects(cid)(Perspectives_DataTypeTripleGetters.typeVanIedereRolInContextM)))(function (v) {
            return Data_Foldable.for_(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(v)(isDefined);
        });
    };
};
var checkAvailableProperties = function (rolId) {
    return function (contextId) {
        return function (availableProperties) {
            return function (definedProperties) {
                return function (cid) {
                    var isDefined = function (propertyName) {
                        var v = Data_Array.elemIndex(Data_Eq.eqString)(propertyName)(definedProperties);
                        if (v instanceof Data_Maybe.Nothing) {
                            return Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.PropertyNotDefined(cid, propertyName, rolId, contextId) ]);
                        };
                        return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
                    };
                    return Data_Foldable.for_(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(availableProperties)(isDefined);
                };
            };
        };
    };
};
var checkProperties = function (typeId) {
    return function (cid) {
        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Functor["void"](Control_Monad_Writer_Trans.functorWriterT(Control_Monad_State_Trans.functorStateT(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff))))(Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(get(typeId)(Perspectives_ModelBasedTripleGetters.ownInternePropertiesDefM))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(checkInternalProperty(cid)))))(function () {
            return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Functor["void"](Control_Monad_Writer_Trans.functorWriterT(Control_Monad_State_Trans.functorStateT(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff))))(Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(get(typeId)(Perspectives_ModelBasedTripleGetters.ownExternePropertiesDefM))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(comparePropertyInstanceToDefinition(cid)(Perspectives_Identifiers.buitenRol(cid))))))(function () {
                return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(typeId)(Perspectives_ModelBasedTripleGetters.externePropertiesDefM))))(function (v) {
                    return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_DataTypeObjectGetters.propertyTypen(Perspectives_Identifiers.buitenRol(cid)))))(function (v1) {
                        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(checkAvailableProperties(Perspectives_Identifiers.buitenRol(cid))(typeId)(v1)(v)(cid))(function () {
                            return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(typeId)(Perspectives_ModelBasedTripleGetters.internePropertiesDefM))))(function (v2) {
                                return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_DataTypeObjectGetters.internePropertyTypen(cid))))(function (v3) {
                                    return checkAvailableProperties(Perspectives_Identifiers.binnenRol(cid))(typeId)(v3)(v)(cid);
                                });
                            });
                        });
                    });
                });
            });
        });
    };
};
var compareRolInstancesToDefinition = function (cid) {
    return function (rolType$prime) {
        var compareRolInstanceToDefinition = function (rolId) {
            return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetterToObjects(rolType$prime)(Perspectives_ModelBasedTripleGetters.propertiesDefM)))(function (v) {
                return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Functor["void"](Control_Monad_Writer_Trans.functorWriterT(Control_Monad_State_Trans.functorStateT(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff))))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(comparePropertyInstanceToDefinition(cid)(rolId))(v)))(function () {
                    return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(rolType$prime)(Perspectives_ModelBasedTripleGetters.propertiesDefM))))(function (v1) {
                        return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_DataTypeObjectGetters.propertyTypen(rolId))))(function (v2) {
                            return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(checkAvailableProperties(rolId)(rolType$prime)(v2)(v1)(cid))(function () {
                                return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetter(rolId)(Perspectives_TripleGetterComposition.composeTripleGetters(Perspectives_DataTypeTripleGetters.bindingM)(Perspectives_DataTypeTripleGetters.contextM))))(function (v3) {
                                    return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetterToMaybeObject(rolType$prime)(Perspectives_ModelBasedTripleGetters.bindingDefM)))(function (v4) {
                                        if (v4 instanceof Data_Maybe.Nothing) {
                                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
                                        };
                                        if (v4 instanceof Data_Maybe.Just) {
                                            return Control_Bind.ifM(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perpectives_TypeChecker.contextHasType(Perspectives_CoreTypes.tripleObject(v3))(v4.value0))))(Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit))(Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetter(Perspectives_CoreTypes.tripleObject(v3))(Perspectives_DataTypeTripleGetters.contextTypeM)))(function (v5) {
                                                return Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.IncorrectBinding(cid, rolId, Perspectives_CoreTypes.tripleObject(v3), Perspectives_CoreTypes.tripleObject(v5), v4.value0) ]);
                                            }));
                                        };
                                        throw new Error("Failed pattern match at Perspectives.TypeDefChecker line 218, column 7 - line 225, column 127: " + [ v4.constructor.name ]);
                                    });
                                });
                            });
                        });
                    });
                });
            });
        };
        return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_ObjectGetterConstructors.getRolUsingAspects(rolType$prime)(cid))))(function (v) {
            var v1 = Data_Array.head(v);
            if (v1 instanceof Data_Maybe.Nothing) {
                return Control_Bind.ifM(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(rolIsMandatory(rolType$prime)))(Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.MissingRolInstance(rolType$prime, cid) ]))(Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit));
            };
            return Data_Functor["void"](Control_Monad_Writer_Trans.functorWriterT(Control_Monad_State_Trans.functorStateT(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff))))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(compareRolInstanceToDefinition)(v));
        });
    };
};
var checkDefinedRoles = function (typeId) {
    return function (cid) {
        return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(typeId)(Perspectives_ModelBasedTripleGetters.rollenDefM))))(function (v) {
            return Data_Functor["void"](Control_Monad_Writer_Trans.functorWriterT(Control_Monad_State_Trans.functorStateT(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff))))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(compareRolInstancesToDefinition(cid))(v));
        });
    };
};
var checkAspectOfRolType = function (cid) {
    return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToMaybeObject(cid)(Perspectives_ModelBasedTripleGetters.contextDefM))))(function (v) {
        if (v instanceof Data_Maybe.Nothing) {
            return Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.RolWithoutContext(cid) ]);
        };
        if (v instanceof Data_Maybe.Just) {
            return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(cid)(Perspectives_ModelBasedTripleGetters.aspectRollenDefM))))(function (v1) {
                var v2 = Data_Array.head(v1);
                if (v2 instanceof Data_Maybe.Nothing) {
                    return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
                };
                if (v2 instanceof Data_Maybe.Just) {
                    return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(v.value0)(Perspectives_TripleGetterComposition.composeTripleGetters(Perspectives_ModelBasedTripleGetters.aspectenDefM)(Perspectives_ModelBasedTripleGetters.rollenDefM)))))(function (v3) {
                        var $77 = Data_Maybe.isJust(Data_Array.elemIndex(Data_Eq.eqString)(v2.value0)(v3));
                        if ($77) {
                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
                        };
                        return Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.AspectRolNotFromAspect(cid, v2.value0, v.value0) ]);
                    });
                };
                throw new Error("Failed pattern match at Perspectives.TypeDefChecker line 237, column 7 - line 243, column 67: " + [ v2.constructor.name ]);
            });
        };
        throw new Error("Failed pattern match at Perspectives.TypeDefChecker line 233, column 3 - line 243, column 67: " + [ v.constructor.name ]);
    });
};
var checkContext$prime = function (cid) {
    return Perspectives_Utilities.ifNothing(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Perspectives_CoreTypes.applyTypedTripleGetterToMaybeObject(cid)(Perspectives_DataTypeTripleGetters.contextTypeM)))(Control_Monad_Writer_Class.tell(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))([ new Perspectives_CoreTypes.MissingType(cid) ]))(function (tp) {
        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(checkProperties(tp)(cid))(function () {
            return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(checkDefinedRoles(tp)(cid))(function () {
                return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(checkAvailableRoles(tp)(cid))(function () {
                    return Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perpectives_TypeChecker.contextHasType(cid)("model:Perspectives$Rol"))))(function (v) {
                        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))((function () {
                            if (v) {
                                return checkAspectOfRolType(cid);
                            };
                            return Control_Applicative.pure(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
                        })())(function () {
                            return checkCyclicAspects(cid);
                        });
                    });
                });
            });
        });
    });
};
var checkContext = function (cid) {
    return Perspectives_RunMonadPerspectivesQuery.runMonadPerspectivesQuery(cid)(function (x) {
        return Control_Monad_Writer_Trans.execWriterT(Control_Monad_State_Trans.functorStateT(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff)))(checkContext$prime(x));
    });
};
var checkModel = function (modelId) {
    var checkAllContexts = function (x) {
        return Control_Monad_Writer_Trans.execWriterT(Control_Monad_State_Trans.functorStateT(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff)))(Control_Bind.bind(Control_Monad_Writer_Trans.bindWriterT(Data_Semigroup.semigroupArray)(Control_Monad_State_Trans.bindStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidArray))(Control_Monad_State_Trans.monadStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_DomeinCache.retrieveDomeinFile(modelId))))(function (v) {
            return Data_Foldable.for_(Control_Monad_Writer_Trans.applicativeWriterT(Data_Monoid.monoidArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(Data_StrMap.keys(v.contexts))(checkContext$prime);
        }));
    };
    return Perspectives_RunMonadPerspectivesQuery.runMonadPerspectivesQuery(modelId)(checkAllContexts);
};
module.exports = {
    checkContext: checkContext,
    checkModel: checkModel,
    getPropertyFunction: getPropertyFunction
};
