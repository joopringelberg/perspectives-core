// Generated by purs version 0.11.7
"use strict";
var Control_Applicative = require("../Control.Applicative");
var Control_Apply = require("../Control.Apply");
var Control_Bind = require("../Control.Bind");
var Control_Category = require("../Control.Category");
var Control_Monad = require("../Control.Monad");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad_Reader_Trans = require("../Control.Monad.Reader.Trans");
var Control_Monad_State = require("../Control.Monad.State");
var Control_Monad_State_Class = require("../Control.Monad.State.Class");
var Control_Monad_State_Trans = require("../Control.Monad.State.Trans");
var Control_Monad_Trans_Class = require("../Control.Monad.Trans.Class");
var Control_Monad_Writer = require("../Control.Monad.Writer");
var Control_Monad_Writer_Class = require("../Control.Monad.Writer.Class");
var Control_Monad_Writer_Trans = require("../Control.Monad.Writer.Trans");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_Array = require("../Data.Array");
var Data_Eq = require("../Data.Eq");
var Data_Foldable = require("../Data.Foldable");
var Data_Function = require("../Data.Function");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra");
var Data_Maybe = require("../Data.Maybe");
var Data_Monoid = require("../Data.Monoid");
var Data_Ring = require("../Data.Ring");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Semiring = require("../Data.Semiring");
var Data_StrMap = require("../Data.StrMap");
var Data_String = require("../Data.String");
var Data_Traversable = require("../Data.Traversable");
var Data_Tuple = require("../Data.Tuple");
var Data_Unit = require("../Data.Unit");
var Partial_Unsafe = require("../Partial.Unsafe");
var Perspectives_ContextAndRole = require("../Perspectives.ContextAndRole");
var Perspectives_CoreTypes = require("../Perspectives.CoreTypes");
var Perspectives_DataTypeTripleGetters = require("../Perspectives.DataTypeTripleGetters");
var Perspectives_Effects = require("../Perspectives.Effects");
var Perspectives_EntiteitAndRDFAliases = require("../Perspectives.EntiteitAndRDFAliases");
var Perspectives_Identifiers = require("../Perspectives.Identifiers");
var Perspectives_PerspectEntiteit = require("../Perspectives.PerspectEntiteit");
var Perspectives_QueryCombinators = require("../Perspectives.QueryCombinators");
var Perspectives_Resource = require("../Perspectives.Resource");
var Perspectives_RunMonadPerspectivesQuery = require("../Perspectives.RunMonadPerspectivesQuery");
var Perspectives_Syntax = require("../Perspectives.Syntax");
var Perspectives_TripleGetterComposition = require("../Perspectives.TripleGetterComposition");
var Perspectives_TripleGetterConstructors = require("../Perspectives.TripleGetterConstructors");
var Prelude = require("../Prelude");
var strMapTraverse_ = function (dictMonad) {
    return function (f) {
        return function (map) {
            return Data_StrMap.foldM(dictMonad)(function (z) {
                return function (s) {
                    return function (a) {
                        return f(s)(a);
                    };
                };
            })(Data_Unit.unit)(map);
        };
    };
};
var space = Control_Monad_Writer_Class.tell(Control_Monad_State_Trans.monadTellStateT(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(" ");
var runPerspectText = function (t) {
    return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Control_Monad_Writer_Trans.runWriterT(Control_Monad_State_Trans.evalStateT(Control_Monad_Writer_Trans.functorWriterT(Control_Monad_Reader_Trans.functorReaderT(Control_Monad_Aff.functorAff)))(t)(0)))(function (v) {
        return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Data_Tuple.snd(v));
    });
};
var prettyPrint = function (t) {
    return function (pp) {
        return runPerspectText(pp(t));
    };
};
var newline = Control_Monad_Writer_Class.tell(Control_Monad_State_Trans.monadTellStateT(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))("\x0a");
var indent = function (p) {
    return function (a) {
        return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_State_Class.modify(Control_Monad_State_Trans.monadStateStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(function (i) {
            return i + 1 | 0;
        }))(function (v) {
            return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(p(a))(function (v1) {
                return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_State_Class.modify(Control_Monad_State_Trans.monadStateStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(function (i) {
                    return i - 1 | 0;
                }))(function (v2) {
                    return Control_Applicative.pure(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(v1);
                });
            });
        });
    };
};
var identifier$prime = function (s) {
    return Control_Monad_Writer_Class.tell(Control_Monad_State_Trans.monadTellStateT(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(s + " ");
};
var simpleValue = function (v) {
    if (v.length === 1) {
        return identifier$prime(v[0]);
    };
    return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(identifier$prime)(v))(function (v1) {
        return Control_Applicative.pure(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Unit.unit);
    });
};
var identifier = function (s) {
    return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_State_Class.get(Control_Monad_State_Trans.monadStateStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))))(function (v) {
        return Control_Monad_Writer_Class.tell(Control_Monad_State_Trans.monadTellStateT(Control_Monad_Writer_Trans.monadTellWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_String.fromCharArray(Data_Array.replicate(v)("\x09")) + (s + " "));
    });
};
var getCommentBefore = function (v) {
    return v.commentBefore;
};
var getCommentAfter = function (v) {
    return v.commentAfter;
};
var fullContextDeclaration = function (x) {
    return Control_Apply.applySecond(Control_Monad_State_Trans.applyStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(identifier(Perspectives_ContextAndRole.context_pspType(x)))(identifier$prime(Perspectives_ContextAndRole.context_Namespace(x) + ("$" + Perspectives_ContextAndRole.context_displayName(x))));
};
var contextDeclaration = function (x) {
    return Control_Apply.applySecond(Control_Monad_State_Trans.applyStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(identifier(Perspectives_ContextAndRole.context_pspType(x)))(identifier$prime("$" + Perspectives_ContextAndRole.context_displayName(x)));
};
var comment$prime = function (c) {
    return identifier$prime("--" + c);
};
var comment = function (c) {
    return Control_Apply.applySecond(Control_Monad_State_Trans.applyStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(identifier("--" + c))(newline);
};
var property = function (keyword) {
    return function (prop) {
        var withPVComments = function (v) {
            return function (p) {
                return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(comment)(v.commentBefore))(function () {
                    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(p)(function () {
                        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(comment$prime)(v.commentAfter))(function () {
                            return newline;
                        });
                    });
                });
            };
        };
        return indent(function (pvcomments) {
            return withPVComments(pvcomments)(Control_Apply.applySecond(Control_Monad_State_Trans.applyStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Apply.applySecond(Control_Monad_State_Trans.applyStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(keyword)(identifier$prime(prop + " =")))(simpleValue(Perspectives_Syntax.propertyValue(pvcomments))));
        });
    };
};
var privateProperty = property(identifier("intern"));
var publicProperty = property(identifier("extern"));
var roleProperty = property(identifier(""));
var withComments = function (getComments) {
    return function (p) {
        return function (el) {
            var v = getComments(el);
            return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(comment)(v.commentBefore))(function () {
                return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(p(el))(function () {
                    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(space)(function () {
                        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(comment$prime)(v.commentAfter))(function () {
                            return newline;
                        });
                    });
                });
            });
        };
    };
};
var withComments$prime = function (v) {
    return function (p) {
        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(comment)(v.commentBefore))(function () {
            return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(p)(function () {
                return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(comment$prime)(v.commentAfter))(function () {
                    return newline;
                });
            });
        });
    };
};
var context = function (definedResources) {
    return function (c) {
        var reference = function (role) {
            return function (binding) {
                return withComments$prime(Perspectives_ContextAndRole.rol_comments(role))(identifier(Perspectives_ContextAndRole.rol_pspType(role) + (" => " + Perspectives_ContextAndRole.rol_context(binding))));
            };
        };
        var roleBinding = function (role) {
            var v = Data_Maybe.fromJust()(Perspectives_ContextAndRole.rol_binding(role));
            var v1 = Data_Maybe.maybe("")(Control_Category.id(Control_Category.categoryFn))(Perspectives_Identifiers.roleIndexNr(Perspectives_ContextAndRole.rol_id(role)));
            return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))((function () {
                var v2 = Data_Array.elemIndex(Data_Eq.eqString)(v)(definedResources);
                if (v2 instanceof Data_Maybe.Nothing) {
                    return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_Resource.getPerspectEntiteit(Perspectives_PerspectEntiteit.perspectEntiteitRol)(v))))(function (v3) {
                        var v4 = Perspectives_ContextAndRole.rol_pspType(v3) === "model:Perspectives$Context$buitenRol";
                        if (v4) {
                            var $52 = Perspectives_Identifiers.isInNamespace(Perspectives_ContextAndRole.context_id(c))(Perspectives_ContextAndRole.rol_context(v3));
                            if ($52) {
                                return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_Resource.getPerspectEntiteit(Perspectives_PerspectEntiteit.perspectEntiteitContext)(Perspectives_ContextAndRole.rol_context(v3)))))(function (v5) {
                                    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(withComments$prime(Perspectives_ContextAndRole.rol_comments(role))(identifier(Perspectives_ContextAndRole.rol_pspType(role) + " => ")))(function () {
                                        return indent(context(definedResources))(v5);
                                    });
                                });
                            };
                            return reference(role)(v3);
                        };
                        if (!v4) {
                            return reference(role)(v3);
                        };
                        throw new Error("Failed pattern match at Perspectives.PrettyPrinter line 166, column 15 - line 178, column 49: " + [ v4.constructor.name ]);
                    });
                };
                return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_Resource.getPerspectEntiteit(Perspectives_PerspectEntiteit.perspectEntiteitRol)(v))))(function (v3) {
                    return reference(role)(v3);
                });
            })())(function () {
                return strMapTraverse_(Control_Monad_State_Trans.monadStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(roleProperty)(Perspectives_ContextAndRole.rol_properties(role));
            });
        };
        var publicProperties = Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_Resource.getPerspectEntiteit(Perspectives_PerspectEntiteit.perspectEntiteitRol)(Perspectives_ContextAndRole.context_buitenRol(c)))))(function (v) {
            return strMapTraverse_(Control_Monad_State_Trans.monadStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(publicProperty)(Perspectives_ContextAndRole.rol_properties(v));
        });
        var privateProperties = strMapTraverse_(Control_Monad_State_Trans.monadStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(privateProperty)(Perspectives_ContextAndRole.rol_properties(Perspectives_ContextAndRole.context_binnenRol(c)));
        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(withComments(Perspectives_ContextAndRole.context_comments)(contextDeclaration)(c))(function () {
            return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(publicProperties)(function () {
                return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(privateProperties)(function () {
                    return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(function ($62) {
                        return Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_Resource.getPerspectEntiteit(Perspectives_PerspectEntiteit.perspectEntiteitRol)($62)));
                    })(Control_Bind.join(Control_Bind.bindArray)(Data_StrMap.values(Perspectives_ContextAndRole.context_rolInContext(c)))))(function (v) {
                        return Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(indent(roleBinding))(Data_Array.sortBy(Perspectives_ContextAndRole.compareOccurrences)(v));
                    });
                });
            });
        });
    };
};
var enclosingContext = function (theText) {
    var ppContext = function (definedContexts) {
        return function (id) {
            return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_Resource.getPerspectEntiteit(Perspectives_PerspectEntiteit.perspectEntiteitContext)(id))))(function (v) {
                var $58 = Perspectives_Identifiers.isInNamespace(id)(Perspectives_ContextAndRole.context_id(theText)) || Perspectives_Identifiers.isInNamespace(id)("model:User");
                if ($58) {
                    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(context(definedContexts)(v))(function () {
                        return newline;
                    });
                };
                return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(withComments(Perspectives_ContextAndRole.context_comments)(fullContextDeclaration)(v))(function () {
                    return newline;
                });
            });
        };
    };
    var section = function (sectionId) {
        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(identifier$prime("Section"))(function () {
            return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(identifier(sectionId))(function () {
                return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(newline)(function () {
                    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(newline)(function () {
                        return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(Perspectives_ContextAndRole.context_id(theText))(Perspectives_QueryCombinators.ignoreCache(Perspectives_TripleGetterComposition.composeTripleGetters(Perspectives_TripleGetterConstructors.constructRolGetter(sectionId))(Perspectives_DataTypeTripleGetters.bindingM))))))(function (v) {
                            return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(Perspectives_ContextAndRole.context_id(theText))(Perspectives_QueryCombinators.ignoreCache(Perspectives_TripleGetterComposition.composeTripleGetters(Perspectives_TripleGetterComposition.composeTripleGetters(Perspectives_TripleGetterConstructors.constructRolGetter(sectionId))(Perspectives_DataTypeTripleGetters.bindingM))(Perspectives_DataTypeTripleGetters.contextM))))))(function (v1) {
                                return Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(ppContext(v))(v1);
                            });
                        });
                    });
                });
            });
        });
    };
    return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(withComments$prime(Perspectives_ContextAndRole.context_comments(theText))(identifier("Context " + Perspectives_ContextAndRole.context_displayName(theText))))(function () {
        return Control_Bind.discard(Control_Bind.discardUnit)(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(newline)(function () {
            return Control_Bind.bind(Control_Monad_State_Trans.bindStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Control_Monad_Trans_Class.lift(Control_Monad_State_Trans.monadTransStateT)(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff)))(Control_Monad_Trans_Class.lift(Control_Monad_Writer_Trans.monadTransWriterT(Data_Monoid.monoidString))(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))(Perspectives_RunMonadPerspectivesQuery.runTypedTripleGetterToObjects(Perspectives_ContextAndRole.context_id(theText))(Perspectives_QueryCombinators.ignoreCache(Perspectives_DataTypeTripleGetters.typeVanIedereRolInContextM)))))(function (v) {
                return Data_Foldable.traverse_(Control_Monad_State_Trans.applicativeStateT(Control_Monad_Writer_Trans.monadWriterT(Data_Monoid.monoidString)(Control_Monad_Reader_Trans.monadReaderT(Control_Monad_Aff.monadAff))))(Data_Foldable.foldableArray)(section)(v);
            });
        });
    });
};
module.exports = {
    identifier: identifier,
    "identifier'": identifier$prime,
    simpleValue: simpleValue,
    space: space,
    newline: newline,
    comment: comment,
    "comment'": comment$prime,
    prettyPrint: prettyPrint,
    runPerspectText: runPerspectText,
    indent: indent,
    withComments: withComments,
    "withComments'": withComments$prime,
    getCommentBefore: getCommentBefore,
    getCommentAfter: getCommentAfter,
    property: property,
    publicProperty: publicProperty,
    privateProperty: privateProperty,
    roleProperty: roleProperty,
    contextDeclaration: contextDeclaration,
    fullContextDeclaration: fullContextDeclaration,
    context: context,
    strMapTraverse_: strMapTraverse_,
    enclosingContext: enclosingContext
};
