// Generated by purs version 0.11.7
"use strict";
var Control_Alt = require("../Control.Alt");
var Control_Applicative = require("../Control.Applicative");
var Control_Bind = require("../Control.Bind");
var Control_Category = require("../Control.Category");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad_Reader_Trans = require("../Control.Monad.Reader.Trans");
var Control_Plus = require("../Control.Plus");
var Data_Array = require("../Data.Array");
var Data_Eq = require("../Data.Eq");
var Data_Foldable = require("../Data.Foldable");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_HeytingAlgebra = require("../Data.HeytingAlgebra");
var Data_Maybe = require("../Data.Maybe");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Show = require("../Data.Show");
var Data_StrMap = require("../Data.StrMap");
var Perspectives_ContextAndRole = require("../Perspectives.ContextAndRole");
var Perspectives_ContextRolAccessors = require("../Perspectives.ContextRolAccessors");
var Perspectives_CoreTypes = require("../Perspectives.CoreTypes");
var Perspectives_DataTypeObjectGetters = require("../Perspectives.DataTypeObjectGetters");
var Perspectives_EntiteitAndRDFAliases = require("../Perspectives.EntiteitAndRDFAliases");
var Perspectives_Identifiers = require("../Perspectives.Identifiers");
var Perspectives_ObjectsGetterComposition = require("../Perspectives.ObjectsGetterComposition");
var Perspectives_Syntax = require("../Perspectives.Syntax");
var Prelude = require("../Prelude");
var unlessNull = function (og) {
    return function (id) {
        return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(og(id))(function (r) {
            var $3 = Data_Array["null"](r);
            if ($3) {
                return Control_Plus.empty(Control_Monad_Reader_Trans.plusReaderT(Control_Monad_Aff.plusAff));
            };
            return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(r);
        });
    };
};
var getRolByLocalName = function (rn) {
    return Perspectives_ContextRolAccessors.getContextMember(function (context) {
        return Data_Maybe.maybe([  ])(Control_Category.id(Control_Category.categoryFn))(Data_StrMap.lookup(Perspectives_ContextAndRole.context_pspType(context) + ("$" + rn))(Perspectives_ContextAndRole.context_rolInContext(context)));
    });
};
var getRol = function (rn) {
    return Perspectives_ContextRolAccessors.getContextMember(function (context) {
        return Data_Maybe.maybe([  ])(Control_Category.id(Control_Category.categoryFn))(Data_StrMap.lookup(rn)(Perspectives_ContextAndRole.context_rolInContext(context)));
    });
};
var getRolFromPrototypeHierarchy = function (rn) {
    return function (contextId) {
        return Control_Alt.alt(Control_Monad_Reader_Trans.altReaderT(Control_Monad_Aff.altAff))(unlessNull(getRol(rn))(contextId))(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_DataTypeObjectGetters.buitenRol)(Perspectives_DataTypeObjectGetters.binding))(Perspectives_DataTypeObjectGetters.context))(getRolFromPrototypeHierarchy(rn))(contextId));
    };
};
var getRolUsingAspects = function (rolName) {
    return function (contextId) {
        return Control_Alt.alt(Control_Monad_Reader_Trans.altReaderT(Control_Monad_Aff.altAff))(unlessNull(getRolFromPrototypeHierarchy(rolName))(contextId))(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_ObjectsGetterComposition.unionOfObjects(getRol("model:Perspectives$Rol$aspectRol"))(Perspectives_DataTypeObjectGetters.binding))(Perspectives_DataTypeObjectGetters.context))(getRolUsingAspects(rolName))(contextId));
    };
};
var getProperty = function (pn) {
    return Perspectives_ContextRolAccessors.getRolMember(function (rol) {
        return Data_Maybe.maybe([  ])(Perspectives_Syntax.propertyValue)(Data_StrMap.lookup(pn)(Perspectives_ContextAndRole.rol_properties(rol)));
    });
};
var getPropertyFromRolTelescope = function (qn) {
    return function (rolId) {
        return Control_Alt.alt(Control_Monad_Reader_Trans.altReaderT(Control_Monad_Aff.altAff))(unlessNull(getProperty(qn))(rolId))(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_DataTypeObjectGetters.binding)(getPropertyFromRolTelescope(qn))(rolId));
    };
};
var lookupExternalProperty = function (pn) {
    return function (id) {
        return getPropertyFromRolTelescope(pn)(Perspectives_Identifiers.buitenRol(id));
    };
};
var getInternalProperty = function (pn) {
    return function (ident) {
        return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_ContextRolAccessors["getContextMember'"](Perspectives_ContextAndRole.context_binnenRol)(ident))(function (v) {
            if (v instanceof Data_Maybe.Nothing) {
                return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))([  ]);
            };
            if (v instanceof Data_Maybe.Just) {
                return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))(Data_Maybe.maybe([  ])(Perspectives_Syntax.propertyValue)(Data_StrMap.lookup(pn)(Perspectives_ContextAndRole.rol_properties(v.value0))));
            };
            throw new Error("Failed pattern match at Perspectives.ObjectGetterConstructors line 47, column 3 - line 50, column 83: " + [ v.constructor.name ]);
        });
    };
};
var lookupInternalProperty = function (pn) {
    return function (id) {
        return Control_Alt.alt(Control_Monad_Reader_Trans.altReaderT(Control_Monad_Aff.altAff))(unlessNull(getInternalProperty(pn))(id))(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_DataTypeObjectGetters.binding)(getPropertyFromRolTelescope(pn))(id));
    };
};
var getGebondenAls = function (rname) {
    return Perspectives_ContextRolAccessors.getRolMember(function (v) {
        return Data_Maybe.maybe([  ])(Control_Category.id(Control_Category.categoryFn))(Data_StrMap.lookup(rname)(v.gevuldeRollen));
    });
};
var getExternalProperty = function (pn) {
    return function (id) {
        return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Perspectives_DataTypeObjectGetters["buitenRol'"](id))(function (v) {
            if (v instanceof Data_Maybe.Nothing) {
                return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))([  ]);
            };
            if (v instanceof Data_Maybe.Just) {
                return getProperty(pn)(v.value0);
            };
            throw new Error("Failed pattern match at Perspectives.ObjectGetterConstructors line 36, column 3 - line 38, column 35: " + [ v.constructor.name ]);
        });
    };
};
var booleanPropertyGetter = function (aspectRol) {
    return function (propertyName) {
        var getter = function (pid) {
            return Control_Bind.bind(Control_Monad_Reader_Trans.bindReaderT(Control_Monad_Aff.bindAff))(Control_Alt.alt(Control_Monad_Reader_Trans.altReaderT(Control_Monad_Aff.altAff))(unlessNull(getExternalProperty(propertyName))(pid))(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_ObjectsGetterComposition.unionOfObjects(Perspectives_ObjectsGetterComposition.unionOfObjects(getRol(aspectRol))(Perspectives_DataTypeObjectGetters.binding))(Perspectives_DataTypeObjectGetters.context))(getter)(pid)))(function (r) {
                return Control_Applicative.pure(Control_Monad_Reader_Trans.applicativeReaderT(Control_Monad_Aff.applicativeAff))([ Data_Show.show(Data_Show.showBoolean)(Data_Foldable.foldl(Data_Foldable.foldableArray)(Data_HeytingAlgebra.disj(Data_HeytingAlgebra.heytingAlgebraBoolean))(false)(Data_Functor.map(Data_Functor.functorArray)(Data_Eq.eq(Data_Eq.eqString)("true"))(r))) ]);
            });
        };
        return getter;
    };
};
module.exports = {
    getRol: getRol,
    getRolByLocalName: getRolByLocalName,
    getRolFromPrototypeHierarchy: getRolFromPrototypeHierarchy,
    getExternalProperty: getExternalProperty,
    lookupExternalProperty: lookupExternalProperty,
    getInternalProperty: getInternalProperty,
    lookupInternalProperty: lookupInternalProperty,
    unlessNull: unlessNull,
    getGebondenAls: getGebondenAls,
    getProperty: getProperty,
    getPropertyFromRolTelescope: getPropertyFromRolTelescope,
    booleanPropertyGetter: booleanPropertyGetter,
    getRolUsingAspects: getRolUsingAspects
};
