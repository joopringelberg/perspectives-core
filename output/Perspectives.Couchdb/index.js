// Generated by purs version 0.11.7
"use strict";
var Control_Monad_Eff_Exception = require("../Control.Monad.Eff.Exception");
var Control_Monad_Error_Class = require("../Control.Monad.Error.Class");
var Data_Array = require("../Data.Array");
var Data_Eq = require("../Data.Eq");
var Data_Foldable = require("../Data.Foldable");
var Data_Foreign_Class = require("../Data.Foreign.Class");
var Data_Foreign_Generic = require("../Data.Foreign.Generic");
var Data_Foreign_Generic_Class = require("../Data.Foreign.Generic.Class");
var Data_Function = require("../Data.Function");
var Data_Generic_Rep = require("../Data.Generic.Rep");
var Data_Map = require("../Data.Map");
var Data_Maybe = require("../Data.Maybe");
var Data_Monoid = require("../Data.Monoid");
var Data_Newtype = require("../Data.Newtype");
var Data_Ord = require("../Data.Ord");
var Data_Semigroup = require("../Data.Semigroup");
var Data_Show = require("../Data.Show");
var Data_Symbol = require("../Data.Symbol");
var Data_Tuple = require("../Data.Tuple");
var Network_HTTP_Affjax_Response = require("../Network.HTTP.Affjax.Response");
var Network_HTTP_StatusCode = require("../Network.HTTP.StatusCode");
var Prelude = require("../Prelude");
var Rev = function (x) {
    return x;
};
var PutCouchdbDocument = function (x) {
    return x;
};
var PostCouchdb_session = function (x) {
    return x;
};
var DocReference = function (x) {
    return x;
};
var GetCouchdbAllDocs = function (x) {
    return x;
};
var DBS = function (x) {
    return x;
};
var newtypePutCouchdbDocument = new Data_Newtype.Newtype(function (n) {
    return n;
}, PutCouchdbDocument);
var newtypePostCouchdb_session = new Data_Newtype.Newtype(function (n) {
    return n;
}, PostCouchdb_session);
var newtypeDBS = new Data_Newtype.Newtype(function (n) {
    return n;
}, DBS);
var newtypeCouchdbAllDocs = new Data_Newtype.Newtype(function (n) {
    return n;
}, GetCouchdbAllDocs);
var genericRef = new Data_Generic_Rep.Generic(function (x) {
    return x.rev;
}, function (x) {
    return {
        rev: x
    };
});
var genericPutCouchdbDocument = new Data_Generic_Rep.Generic(function (x) {
    return new Data_Generic_Rep.Product(x.error, new Data_Generic_Rep.Product(x.id, new Data_Generic_Rep.Product(x.ok, new Data_Generic_Rep.Product(x.reason, x.rev))));
}, function (x) {
    return {
        error: x.value0,
        id: x.value1.value0,
        ok: x.value1.value1.value0,
        reason: x.value1.value1.value1.value0,
        rev: x.value1.value1.value1.value1
    };
});
var respondablePutCouchdbDocument = new Network_HTTP_Affjax_Response.Respondable(Data_Foreign_Generic.genericDecode(genericPutCouchdbDocument)(Data_Foreign_Generic_Class.genericDecodeConstructor(new Data_Symbol.IsSymbol(function () {
    return "PutCouchdbDocument";
}))(Data_Foreign_Generic_Class.genericDecodeArgsRec(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "error";
}))(Data_Foreign_Class.maybeDecode(Data_Foreign_Class.stringDecode)))(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "id";
}))(Data_Foreign_Class.maybeDecode(Data_Foreign_Class.stringDecode)))(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "ok";
}))(Data_Foreign_Class.maybeDecode(Data_Foreign_Class.booleanDecode)))(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "reason";
}))(Data_Foreign_Class.maybeDecode(Data_Foreign_Class.stringDecode)))(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "rev";
}))(Data_Foreign_Class.maybeDecode(Data_Foreign_Class.stringDecode))))))))(Data_Foreign_Generic_Class.genericCountArgsRec))((function () {
    var $67 = {};
    for (var $68 in Data_Foreign_Generic.defaultOptions) {
        if ({}.hasOwnProperty.call(Data_Foreign_Generic.defaultOptions, $68)) {
            $67[$68] = Data_Foreign_Generic["defaultOptions"][$68];
        };
    };
    $67.unwrapSingleConstructors = true;
    return $67;
})()), new Data_Tuple.Tuple(Data_Maybe.Nothing.value, Network_HTTP_Affjax_Response.JSONResponse.value));
var genericPostCouchdb_session = new Data_Generic_Rep.Generic(function (x) {
    return new Data_Generic_Rep.Product(x.name, new Data_Generic_Rep.Product(x.ok, x.roles));
}, function (x) {
    return {
        name: x.value0,
        ok: x.value1.value0,
        roles: x.value1.value1
    };
});
var respondablePostCouchdb_session = new Network_HTTP_Affjax_Response.Respondable(Data_Foreign_Generic.genericDecode(genericPostCouchdb_session)(Data_Foreign_Generic_Class.genericDecodeConstructor(new Data_Symbol.IsSymbol(function () {
    return "PostCouchdb_session";
}))(Data_Foreign_Generic_Class.genericDecodeArgsRec(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "name";
}))(Data_Foreign_Class.maybeDecode(Data_Foreign_Class.stringDecode)))(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "ok";
}))(Data_Foreign_Class.booleanDecode))(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "roles";
}))(Data_Foreign_Class.arrayDecode(Data_Foreign_Class.stringDecode))))))(Data_Foreign_Generic_Class.genericCountArgsRec))((function () {
    var $79 = {};
    for (var $80 in Data_Foreign_Generic.defaultOptions) {
        if ({}.hasOwnProperty.call(Data_Foreign_Generic.defaultOptions, $80)) {
            $79[$80] = Data_Foreign_Generic["defaultOptions"][$80];
        };
    };
    $79.unwrapSingleConstructors = true;
    return $79;
})()), new Data_Tuple.Tuple(Data_Maybe.Nothing.value, Network_HTTP_Affjax_Response.JSONResponse.value));
var genericDocReference = new Data_Generic_Rep.Generic(function (x) {
    return new Data_Generic_Rep.Product(x.id, x.value);
}, function (x) {
    return {
        id: x.value0,
        value: x.value1
    };
});
var genericDBS = new Data_Generic_Rep.Generic(function (x) {
    return x;
}, function (x) {
    return x;
});
var respondableDBS = new Network_HTTP_Affjax_Response.Respondable(Data_Foreign_Generic.genericDecode(genericDBS)(Data_Foreign_Generic_Class.genericDecodeConstructor(new Data_Symbol.IsSymbol(function () {
    return "DBS";
}))(Data_Foreign_Generic_Class.genericDecodeArgsArgument(Data_Foreign_Class.arrayDecode(Data_Foreign_Class.stringDecode)))(Data_Foreign_Generic_Class.genericCountArgsArgument))((function () {
    var $90 = {};
    for (var $91 in Data_Foreign_Generic.defaultOptions) {
        if ({}.hasOwnProperty.call(Data_Foreign_Generic.defaultOptions, $91)) {
            $90[$91] = Data_Foreign_Generic["defaultOptions"][$91];
        };
    };
    $90.unwrapSingleConstructors = true;
    return $90;
})()), new Data_Tuple.Tuple(Data_Maybe.Nothing.value, Network_HTTP_Affjax_Response.JSONResponse.value));
var genericCouchdbAllDocs = new Data_Generic_Rep.Generic(function (x) {
    return new Data_Generic_Rep.Product(x.offset, new Data_Generic_Rep.Product(x.rows, new Data_Generic_Rep.Product(x.total_rows, x.update_seq)));
}, function (x) {
    return {
        offset: x.value0,
        rows: x.value1.value0,
        total_rows: x.value1.value1.value0,
        update_seq: x.value1.value1.value1
    };
});
var decodeRev = new Data_Foreign_Class.Decode(Data_Foreign_Generic.genericDecode(genericRef)(Data_Foreign_Generic_Class.genericDecodeConstructor(new Data_Symbol.IsSymbol(function () {
    return "Rev";
}))(Data_Foreign_Generic_Class.genericDecodeArgsRec(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "rev";
}))(Data_Foreign_Class.stringDecode)))(Data_Foreign_Generic_Class.genericCountArgsRec))((function () {
    var $105 = {};
    for (var $106 in Data_Foreign_Generic.defaultOptions) {
        if ({}.hasOwnProperty.call(Data_Foreign_Generic.defaultOptions, $106)) {
            $105[$106] = Data_Foreign_Generic["defaultOptions"][$106];
        };
    };
    $105.unwrapSingleConstructors = true;
    return $105;
})()));
var decodeDocReference = new Data_Foreign_Class.Decode(Data_Foreign_Generic.genericDecode(genericDocReference)(Data_Foreign_Generic_Class.genericDecodeConstructor(new Data_Symbol.IsSymbol(function () {
    return "DocReference";
}))(Data_Foreign_Generic_Class.genericDecodeArgsRec(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "id";
}))(Data_Foreign_Class.stringDecode))(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "value";
}))(decodeRev))))(Data_Foreign_Generic_Class.genericCountArgsRec))((function () {
    var $108 = {};
    for (var $109 in Data_Foreign_Generic.defaultOptions) {
        if ({}.hasOwnProperty.call(Data_Foreign_Generic.defaultOptions, $109)) {
            $108[$109] = Data_Foreign_Generic["defaultOptions"][$109];
        };
    };
    $108.unwrapSingleConstructors = true;
    return $108;
})()));
var respondableGetCouchdbAllDocs = new Network_HTTP_Affjax_Response.Respondable(Data_Foreign_Generic.genericDecode(genericCouchdbAllDocs)(Data_Foreign_Generic_Class.genericDecodeConstructor(new Data_Symbol.IsSymbol(function () {
    return "GetCouchdbAllDocs";
}))(Data_Foreign_Generic_Class.genericDecodeArgsRec(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "offset";
}))(Data_Foreign_Class.intDecode))(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "rows";
}))(Data_Foreign_Class.arrayDecode(decodeDocReference)))(Data_Foreign_Generic_Class.genericDecodeFieldsProduct(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "total_rows";
}))(Data_Foreign_Class.intDecode))(Data_Foreign_Generic_Class.genericDecodeFieldsField(new Data_Symbol.IsSymbol(function () {
    return "update_seq";
}))(Data_Foreign_Class.maybeDecode(Data_Foreign_Class.intDecode)))))))(Data_Foreign_Generic_Class.genericCountArgsRec))((function () {
    var $111 = {};
    for (var $112 in Data_Foreign_Generic.defaultOptions) {
        if ({}.hasOwnProperty.call(Data_Foreign_Generic.defaultOptions, $112)) {
            $111[$112] = Data_Foreign_Generic["defaultOptions"][$112];
        };
    };
    $111.unwrapSingleConstructors = true;
    return $111;
})()), new Data_Tuple.Tuple(Data_Maybe.Nothing.value, Network_HTTP_Affjax_Response.JSONResponse.value));
var couchdDBStatusCodes = Data_Map.fromFoldable(Data_Ord.ordInt)(Data_Foldable.foldableArray)([ new Data_Tuple.Tuple(200, "OK. Request completed successfully"), new Data_Tuple.Tuple(201, "Created. Document created successfully."), new Data_Tuple.Tuple(202, "Accepted. Request has been accepted, but the corresponding operation may not have completed. This is used for background operations, such as database compaction."), new Data_Tuple.Tuple(304, "Not Modified. The additional content requested has not been modified. This is used with the ETag system to identify the version of information returned."), new Data_Tuple.Tuple(400, "Bad Request. Bad request structure. The error can indicate an error with the request URL, path or headers. Differences in the supplied MD5 hash and content also trigger this error, as this may indicate message corruption."), new Data_Tuple.Tuple(401, "Unauthorized. The item requested was not available using the supplied authorization, or authorization was not supplied."), new Data_Tuple.Tuple(403, "Forbidden. The requested item or operation is forbidden."), new Data_Tuple.Tuple(404, "Not found. The requested content could not be found. The content will include further information, as a JSON object, if available. The structure will contain two keys, error and reason."), new Data_Tuple.Tuple(405, "Resource not allowed. A request was made using an invalid HTTP request type for the URL requested. For example, you have requested a PUT when a POST is required. Errors of this type can also triggered by invalid URL strings."), new Data_Tuple.Tuple(406, "Not acceptable. The requested content type is not supported by the server."), new Data_Tuple.Tuple(409, "Conflict. Request resulted in an update conflict."), new Data_Tuple.Tuple(412, "Precondition failed. The request headers from the client and the capabilities of the server do not match."), new Data_Tuple.Tuple(415, "Bad Content type. The content types supported, and the content type of the information being requested or submitted indicate that the content type is not supported."), new Data_Tuple.Tuple(416, "Requested Range not satisfiable. The range specified in the request header cannot be satisfied by the server."), new Data_Tuple.Tuple(417, "Expectation failed. When sending documents in bulk, the bulk load operation failed."), new Data_Tuple.Tuple(500, "Internal server error. The request was invalid, either because the supplied JSON was invalid, or invalid information was supplied as part of the request.") ]);
var handleError = function (dictMonadError) {
    return function (n) {
        return function (statusCodes) {
            return function (fname) {
                var $114 = n === 401;
                if ($114) {
                    return Control_Monad_Error_Class.throwError(dictMonadError.MonadThrow0())(Control_Monad_Eff_Exception.error("UNAUTHORIZED"));
                };
                var v = Data_Map.lookup(Data_Ord.ordInt)(n)(statusCodes);
                if (v instanceof Data_Maybe.Just) {
                    return Control_Monad_Error_Class.throwError(dictMonadError.MonadThrow0())(Control_Monad_Eff_Exception.error("Failure in " + (fname + (". " + v.value0))));
                };
                if (v instanceof Data_Maybe.Nothing) {
                    var v1 = Data_Map.lookup(Data_Ord.ordInt)(n)(couchdDBStatusCodes);
                    if (v1 instanceof Data_Maybe.Just) {
                        return Control_Monad_Error_Class.throwError(dictMonadError.MonadThrow0())(Control_Monad_Eff_Exception.error("Failure in " + (fname + (". " + v1.value0))));
                    };
                    if (v1 instanceof Data_Maybe.Nothing) {
                        return Control_Monad_Error_Class.throwError(dictMonadError.MonadThrow0())(Control_Monad_Eff_Exception.error("Failure in " + (fname + (". " + ("Unknown HTTP statuscode " + Data_Show.show(Data_Show.showInt)(n))))));
                    };
                    throw new Error("Failed pattern match at Perspectives.Couchdb line 150, column 11 - line 152, column 114: " + [ v1.constructor.name ]);
                };
                throw new Error("Failed pattern match at Perspectives.Couchdb line 147, column 7 - line 152, column 114: " + [ v.constructor.name ]);
            };
        };
    };
};
var onAccepted = function (dictMonadError) {
    return function (v) {
        return function (statusCodes) {
            return function (fname) {
                return function (f) {
                    var v1 = Data_Array.elemIndex(Data_Eq.eqInt)(v)(statusCodes);
                    if (v1 instanceof Data_Maybe.Nothing) {
                        return handleError(dictMonadError)(v)(Data_Monoid.mempty(Data_Map.monoidMap(Data_Ord.ordInt)))(fname);
                    };
                    return f;
                };
            };
        };
    };
};
var onAccepted$prime = function (dictMonadError) {
    return function (specialCodes) {
        return function (v) {
            return function (statusCodes) {
                return function (fname) {
                    return function (f) {
                        var v1 = Data_Array.elemIndex(Data_Eq.eqInt)(v)(statusCodes);
                        if (v1 instanceof Data_Maybe.Nothing) {
                            return handleError(dictMonadError)(v)(specialCodes)(fname);
                        };
                        return f;
                    };
                };
            };
        };
    };
};
module.exports = {
    PutCouchdbDocument: PutCouchdbDocument,
    DBS: DBS,
    GetCouchdbAllDocs: GetCouchdbAllDocs,
    DocReference: DocReference,
    Rev: Rev,
    PostCouchdb_session: PostCouchdb_session,
    couchdDBStatusCodes: couchdDBStatusCodes,
    onAccepted: onAccepted,
    "onAccepted'": onAccepted$prime,
    handleError: handleError,
    genericPutCouchdbDocument: genericPutCouchdbDocument,
    newtypePutCouchdbDocument: newtypePutCouchdbDocument,
    respondablePutCouchdbDocument: respondablePutCouchdbDocument,
    genericDBS: genericDBS,
    newtypeDBS: newtypeDBS,
    respondableDBS: respondableDBS,
    genericCouchdbAllDocs: genericCouchdbAllDocs,
    newtypeCouchdbAllDocs: newtypeCouchdbAllDocs,
    respondableGetCouchdbAllDocs: respondableGetCouchdbAllDocs,
    genericDocReference: genericDocReference,
    decodeDocReference: decodeDocReference,
    genericRef: genericRef,
    decodeRev: decodeRev,
    genericPostCouchdb_session: genericPostCouchdb_session,
    newtypePostCouchdb_session: newtypePostCouchdb_session,
    respondablePostCouchdb_session: respondablePostCouchdb_session
};
