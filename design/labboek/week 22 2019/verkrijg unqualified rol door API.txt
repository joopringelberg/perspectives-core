PRECONDITIES VOOR compileElementaryQueryStep

Ik probeer een Rol op te halen bij een Context, met een lokale naam, via de PerspectivesAPI. 
Concreet: het gaat om de rol 'gebruiker' van psp:PerspectivesSysteem.
Immers, ik vraag 'gebruiker' op van MijnSysteem. 

Dat leidt tot deze functie: 

	getRolFromLocalName :: ContextID -> LocalName -> ApiEffect -> CorrelationIdentifier -> MonadPerspectives Unit
	getRolFromLocalName cid ln setter corrId = do
	  contextType <- cid ##>> DTO.contextType 
	  qf <- getUnqualifiedRolFunction ln contextType
	  subscribeToObjects cid qf setter corrId

getUnqualifiedRolFunction ln contextType

leidt tot:

getUnqualifiedRolFunction = constructUnqualifiedGetter UnqualifiedRol

en: 

constructUnqualifiedGetter ::
  (String -> ElementaryQueryStep) ->
  String ->
  String ->
  MonadPerspectives StringTypedTripleGetter
constructUnqualifiedGetter queryAstConstructor rn ct = do
  r <- runMonadPerspectivesQueryCompiler ct (compileElementaryQueryStep (queryAstConstructor rn) (rn <> "_getterDescription"))
  case r of
    (Left m) -> throwError $ error $ show m
    (Right descriptionId) -> constructQueryFunction descriptionId

zodat we compileElementaryQueryStep aanroepen. Daarin komen we uit bij:

	UnqualifiedRol ln -> ensureAspect (psp "Context")

En daar gaat het om. Klopt het dat ik eis dat het Domein het aspect psp:Context heeft? 
Of moet ik eisen dat het Domein het *type* psp:Context heeft?

Het commentaar bij compileElementaryQueryStep meldt:

	-- | The domain of the resulting function is the value of 'domain' in the
	-- | QueryCompilerEnvironment. 

Oftewel, de getter die we hier laten beschrijven heeft als domein psp:PerspectivesSysteem.

De eis die ik kan stellen, is dat instanties van psp:PerspectivesSysteem een Context zijn - en geen Rol.

Maar hoe stel je vast of iets een Context is?

psp:PerspectivesSysteem is een instantie van psp:Context, via psp:Systeem.

We hebben een X, waarvan het type psp:PerspectivesSysteem is. Daar kan ik dus niet aan zien dat X een context is...

Stel: we hebben een Y, waarvan het type R is. En R is een soort rol, zoals psp:PerspectivesSysteem$gebruiker.  Het *type* van psp:PerspectivesSysteem$gebruiker is psp:Rol.

In analogie: het type van het type van X is psp:Systeem en dat is een psp:Context. 

Dus ik zou moeten vragen of het type van het Domein een psp:Context is - isOrHasAspect psp:Context.